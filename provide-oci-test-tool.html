<html>
    <head>
        <script type="text/javascript">
		
			var CONST_VERSION = 
			"Version 1.12 - New form with OCI data"
			;
		
            function writeParameters(urlFullString) {
                
				var result = "";
				var url = urlFullString.split("?");
				if ( url.length < 2 ) {
					document.writeln("No parameters in URL: ");
					document.writeln(urlFullString);
					return result;
				} 
				var params = url[1].split("&");	
				document.writeln("<H1>" + CONST_VERSION + "</H1>");
				result = "<TABLE>";
                for ( i = 0; i < params.length; i++) {
					result = result + "<TR><TD style='padding: 5px'>";
					var paramNameValue = params[i].split("=");
					if (paramNameValue[0] == "password") {
						paramNameValue[1] = '*****';
					};
					result = result + paramNameValue[0] + "</TD><TD>=</TD><TD style='padding: 5px'>" + paramNameValue[1] + "</TD></TR>";
                    
                }
				result = result + "</TABLE>";
                return result;
            };

            

			function getInput(callback) {
				$('#somediv').html( "<input type='button' id='mybutton' name='Click Me'></input>" );
				$('#mybutton').click( function() { callback("result"); } );
			};

			function processInput (result) {
				alert(result);
			};

			
		
			function display() {
			alert('displayed');
			};
			
			function extractHookURL() {
				
				var urlFullString = window.location.href;
				var result = "";
				var url = urlFullString.split("?");
				if ( url.length < 2 ) {
					return "";
				} 
				var params = url[1].split("&");	
                for ( i = 0; i < params.length; i++) {
				var paramNameValue = params[i].split("=");
				if ( paramNameValue[0] == "HOOK_URL") {
						var hookURL = paramNameValue[1];
						var unescapedURL = unescape(hookURL);
						return unescapedURL;
					};
	            };                
				
				return "";
				
			};
			
			function OnSubmitForm() {	
			  
				hookURL = extractHookURL();
				document.SUBMITFORM.action = hookURL;

			  return true;
			}
			
			function fillDefaults() {
				document.getElementById('hookURLID').text='test';
			};
			
			function writePageContent() {
				var urlFullString = window.location.href;
                var parametersHTML = writeParameters(urlFullString);
				document.write(parametersHTML);
				
			document.write("<H1>Dynamic form with new action from HOOK_URL");			
			document.write("HOOK_URL = " + extractHookURL() );
			document.write("<FORM NAME='SUBMITFORM' ACTION='" + extractHookURL() + "' METHOD='POST' onsubmit=''>");
				
			
			
			document.write("<table>");
					document.write("<TR><TD>Input </TD><TD><input name='ORDER_TEXT' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-EXT_PRODUCT_ID[1]' value='4640000002-CAT|P17'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-LINE[1]' value='1'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-PARENT_ID[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-ORDER_TEXT[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-VENDOR[1]' value='1100000016'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-MANUFACTURER_ID[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-MANUFACTMAT[1]' value='one1'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-MANUFACTCODE[1]' value='Acme Ltd'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-DESCRIPTION[1]' value='HDMI Cable'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-QUANTITY[1]' value='1.00'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-UNIT[1]' value='PCE'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-EXT_SCHEMA_TYPE[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-UNSPSC_CODE[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-LONGTEXT_1:132[]' value='Extra details text for HDMI cable'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CONTRACT[1]' value='4640000002'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CONTRACT_NAME[1]' value='Test contract for D09'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CATALOG_ID[1]' value='4640000002-CAT'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CATALOG_NAME[1]' value='Test catalogue for D09'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-SCOPE_OF_WORK[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-PRICE[1]' value='10.00'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CURRENCY[1]' value='GBP'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-PRICEUNIT[1]' value='1.00'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-LEADTIME[1]' value='10'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-IS_LOWEST_PRICE[1]' value='YES'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CATALOG_TYPE[1]' value='CAT'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-VENDORMAT[1]' value='P17'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-EXT_CATEGORY_ID[1]' value='43202222'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-MATGROUP[1]' value='43202222'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-SUPPLIER_DATA[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-SAFETY_FLAG[1]' value='0'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CHEMICAL_FLAG[1]' value='0'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-MATNR[1]' value='17'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM_PREVIEW_URL[1]' value='https://www.komplettbedrift.no/img/p/1200/1123321.jpg'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-PURCHORG[1]' value='1001'/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CUSTFIELD1[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CUSTFIELD2[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CUSTFIELD3[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CUSTFIELD4[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-CUSTFIELD5[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-ZBRAZIL_NCM[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-ZBRAZIL_ORIGIN[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-ZBRAZIL_USAGE[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-ZBRAZIL_CATEGORY[1]' value=''/></TD></TR>");
					document.write("<TR><TD>Input </TD><TD><input name='NEW_ITEM-ZTAX_CODE[1]' value=''/></TD></TR>");	
				
			document.write("</table>");
			document.write("<input type='submit' name='submit' value='Submit' />");
			document.write("</FORM>");
				
                //document.getElementsByName("my-textarea")[0].value = comment;
            };
        </script>
    </head>
    <body onload="writePageContent();">
	
	<!--<button text="PressMe" onclick="getInput(processInput)"/>-->
     <FORM NAME="SUBMITFORM"
		ACTION=""
		METHOD="POST" onsubmit="OnSubmitForm();">
			<H1>Test OCI response ver 1.7 - dynamic HOOK_URL<H1>
			<table>
				<tr>
					<TD>Param 1: </TD><TD><input name="PARAM1" value="Param 1"/></TD>
				</tr>
				<tr>
					<TD>Param 2: </TD><TD><input name="PARAM1" value="Param 2"/></TD>
				</tr>
				<tr>
					<TD>Param 3: </TD><TD><input name="PARAM1" value="Param 3"/></TD>
				</tr>
				<tr>
					<TD>userId: </TD><TD><input id="userId" name="userId" value="Adam" size="10"/></TD>
				</tr>
				<tr>
					<TD>HOOK_URL: </TD><TD><input id="hookURLID" name="hookURLID" value="extractHookURL();" size="10"/></TD>
				</tr>
			</table>
	  <input type="submit" name="submit" value="Submit" onclick="{ document.SUBMITFORM.submit(); }" />
  	</FORM>

    </body>
</html>

